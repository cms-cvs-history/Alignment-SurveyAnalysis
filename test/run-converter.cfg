process DATACONVERTER = {

  // Geometry definitions
  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi" 
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"	

  service = MessageLogger { 
		untracked vstring destinations = { "cout", "test" } # .log automatically
		untracked vstring statistics = { "cout", "test"}

		untracked vstring categories = { "Alignment" }
		
		untracked PSet cout    = { 
			untracked string threshold = "DEBUG" 
			untracked bool noLineBreaks = true 
		}
		untracked PSet test  = { 
			untracked string threshold = "DEBUG"
			untracked bool noLineBreaks = true 
		}
	}

  // Dummy source
  untracked PSet maxEvents = {untracked int32 input = 1}
  source = EmptySource {
	untracked uint32 firstRun = 1
	untracked uint32 numberEventsInRun = 1
  }
  
  // Output to dbase
  include "CondCore/DBCommon/data/CondDBCommon.cfi"
  replace CondDBCommon.connect = "sqlite_file:TibTidTecAllSurvey.db"    
  # replace CondDBCommon.connect = "oracle://cms_orcoff_int2r/CMS_COND_ALIGNMENT"
  # replace CondDBCommon.DBParameters.authenticationPath="/afs/cern.ch/cms/DB/conddb"
  service = PoolDBOutputService {
        using CondDBCommon
        VPSet toPut = {
            { string record = "TrackerAlignmentRcd" 
              string tag = "TibTidTecAllSurvey_v2" },
            { string record = "TrackerAlignmentErrorRcd"
              string tag = "TibTidTecAllSurveyAPE_v2" }
        }
    } 

  include "Alignment/SurveyAnalysis/data/SurveyInfoScenario.cff"
 
  // Data converter
  module mydataconverter = SurveyDataConverter {

        bool applyCoarseInfo = true

        PSet MisalignmentScenario = {
           using SurveyInfoScenario
        }

        bool applyFineInfo = true 

	PSet textFileNames = {
          untracked string forTIB = "../data/GetTibSurvey/TIBNewSurvey.dat"
          untracked string forTID = "../data/GetTibSurvey/TIDNewSurvey.dat"
        }

        bool applyErrors = true 

        # Measurement errors of
        # 1) TIB cylinders vs TOB
        # 2) TIB shells on cylinders
        # 3) TIB modules on shells	
        vdouble TIBerrors = { 0.075, 0.045, 0.018 }

        # Measurement errors of
        # 1) TOB wheels vs TST (r phi)
        # 2) TOB wheels vs TST (z)
        # 3) TOB rods on wheels
        # 4) TOB modules on rods
        vdouble TOBerrors = { 0.014, 0.050, 0.020 , 0.003 }

        # Measurement errors of
        # 1) TIDs vs barrel
        # 2) TID discs on supports
        # 3) TID rings on discs
        # 4) TID modules on rings
        vdouble TIDerrors = { 0.045, 0.035, 0.0185 , 0.0054 }
        
        # Measurement errors of
        # 1) TECs vs barrel
        # 2) TEC discs on endcaps
        # 3) TEC petals on discs
        # 4) TEC modules on petals
        vdouble TECerrors = { 0.060, 0.015, 0.007 , 0.002 }
  }

  path p = { mydataconverter }

  module print = AsciiOutputModule { }
  endpath ep = { print }

}
