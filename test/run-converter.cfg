process DATACONVERTER = {

  // Geometry definitions
  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi" 
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"	

  service = MessageLogger { 
		untracked vstring destinations = { "cout", "test" } # .log automatically
		untracked vstring statistics = { "cout", "test"}

		untracked vstring categories = { "Alignment" }
		
		untracked PSet cout    = { 
			untracked string threshold = "DEBUG" 
			untracked bool noLineBreaks = true 
		}
		untracked PSet test  = { 
			untracked string threshold = "DEBUG"
			untracked bool noLineBreaks = true 
		}
	}

  // Dummy source
  source = EmptySource {
        untracked int32 maxEvents = 1 
	untracked uint32 firstRun = 1
	untracked uint32 numberEventsInRun = 1
  }
  
  // Output to dbase
  include "CondCore/DBCommon/data/CondDBCommon.cfi"
  replace CondDBCommon.connect = "sqlite_file:TibTidModuleSurvey.db"    
  replace CondDBCommon.catalog = "file:TibTidModuleSurvey.xml"
  service = PoolDBOutputService {
        using CondDBCommon
        VPSet toPut = {
            { string record = "TrackerAlignmentRcd" 
              string tag = "TibTidModuleSurvey_v1" },
            { string record = "TrackerAlignmentErrorRcd"
              string tag = "TibTidModuleSurveyAPEFromDiffs_v1" }
        }
    } 

  // Data converter
  module mydataconverter = SurveyDataConverter {
	PSet textFileNames = {
          untracked string forTIB = "../data/GetTibSurvey/TIBSurvey.dat"
          untracked string forTID = "../data/GetTibSurvey/TIDSurvey.dat"
        }
        untracked string APEapplied = "useFullCorrectionSize"
        double APEshift = 0.01
  }

  path p = { mydataconverter }

  module print = AsciiOutputModule { }
  endpath ep = { print }

}
