process Alignment =
{
    include 'Alignment/SurveyAnalysis/test/alignment.cff'
    include "Alignment/SurveyAnalysis/test/dbSetup.cfi"
	
    source = PoolSource
    {
        untracked vstring fileNames = {'file:root/CMSSW_1_2_0-CSA06ZMuMu.root'}
    }

    untracked PSet maxEvents = { untracked int32 input = 0 }

    es_source = PoolDBESSource
    {
        using dbSetup

        VPSet toGet = { {using valueRcd}, {using errorRcd} }
    }

    replace AlignmentTracks.src = AlCaRecoCSA06ZMuMu # patch to read CSA06 data

    replace AlignmentProducer.ParameterBuilder.Selector =
    {
        PSet layer = {
            vdouble etaRanges = {} # empty array means no restriction
            vdouble zRanges   = {45., 55.} # forward side
            vdouble rRanges   = {}
            vdouble phiRanges = {} # {1.35, 1.55} # top panel
        }

        vstring alignParams = {'PXECDets,111111,layer'}
    }

    replace AlignmentProducer.parameterSelectorSimple = '-1'
    replace AlignmentProducer.randomShift             = 0.1
    replace AlignmentProducer.randomRotation          = 0.1

    replace AlignmentProducer.algoConfig =
    {
        # using DefaultRefitter
        string algoName   = 'SurveyAlignmentAlgorithm'
        string outfile    = 'survey/shifts.root'
        uint32 nIteration = 100
    }

    path p = { AlignmentTracks }
}
